paths:
  /internal/projects/{projectId}/checks/{checkId}/runs:
    get:
      operationId: listCheckRunsByCheck
      summary: List check runs for a check
      description: |
        Returns a paginated list of check runs for the specified check, sorted from latest to oldest.
        Use cursor-based pagination with `after` and `before` parameters to navigate through results.
        Optionally filter by date range using `start` and `end` parameters.
      tags:
        - Check Runs
      security:
        - BearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the project
        - name: checkId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the check
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 50
            minimum: 1
            maximum: 1000
          description: Maximum number of runs to return
        - name: after
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: |
            Cursor for forward pagination. Returns items older than the specified check run ID.
            Use the `next_cursor` from the previous response.
        - name: before
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: |
            Cursor for backward pagination. Returns items newer than the specified check run ID.
            Use the `prev_cursor` from the previous response.
        - name: start
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: |
            Start time for date range filter (RFC3339 format).
            Only returns check runs created at or after this time.
            Example: `2024-01-01T00:00:00Z`
        - name: end
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: |
            End time for date range filter (RFC3339 format).
            Only returns check runs created at or before this time.
            Example: `2024-01-01T23:59:59Z`
      responses:
        '200':
          description: Paginated list of check runs
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/CheckRun'
                    description: Array of check runs, sorted from latest to oldest
                  prev_cursor:
                    type: string
                    format: uuid
                    nullable: true
                    description: |
                      Cursor to retrieve newer items (previous page).
                      Use this value with the `before` parameter.
                      Null if there are no newer items available.
                  next_cursor:
                    type: string
                    format: uuid
                    nullable: true
                    description: |
                      Cursor to retrieve older items (next page).
                      Use this value with the `after` parameter.
                      Null if there are no older items available.
        '400':
          $ref: '#/components/responses/Error'
          description: |
            Bad request. Possible reasons:
            - Invalid project ID format
            - Invalid check ID format
            - Invalid limit value
            - Invalid cursor format (after/before)
            - Invalid date format for start/end (must be RFC3339)
        '401':
          $ref: '#/components/responses/Error'
          description: Unauthorized. Authentication token is missing or invalid.
        '403':
          $ref: '#/components/responses/Error'
          description: Forbidden. User does not have access to the project.
        '404':
          $ref: '#/components/responses/Error'
          description: Check not found or user does not have access.

  /internal/projects/{projectId}/checks/{checkId}/runs/trigger:
    post:
      operationId: triggerCheckRun
      summary: Trigger a check run manually
      description: |
        Manually triggers a check run synchronously and returns the execution results.
        The check is executed immediately using the first configured region.
        The check run is saved to the database and alerts are processed.
      tags:
        - Check Runs
      security:
        - BearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the project
        - name: checkId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the check to trigger
      responses:
        "200":
          description: Check run executed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CheckRun"
        "400":
          $ref: "#/components/responses/Error"
          description: |
            Bad request. Possible reasons:
            - Invalid project ID format
            - Invalid check ID format
            - Check has no regions configured
        "401":
          $ref: "#/components/responses/Error"
          description: Unauthorized. Authentication token is missing or invalid.
        "403":
          $ref: "#/components/responses/Error"
          description: Forbidden. User does not have access to the project.
        "404":
          $ref: "#/components/responses/Error"
          description: Check not found or does not belong to the specified project.
        "500":
          $ref: "#/components/responses/Error"
          description: Internal server error. Failed to execute or save the check run.

  /internal/projects/{projectId}/checks/{checkId}/uptime:
    get:
      operationId: getCheckUptime
      summary: Get uptime data for a check
      description: |
        Returns aggregated uptime data for a check over a specified time period.
        Data is aggregated into time buckets (minute, hour, or day) based on the time range.
        Supports both period presets and custom datetime ranges.
      tags:
        - Check Runs
      security:
        - BearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the project
        - name: checkId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the check
        - name: period
          in: query
          required: false
          schema:
            type: string
            enum: [today, 1hr, 3hr, 24hr, 7d, 30d]
            default: 24hr
          description: |
            Time period preset. Options:
            - `today`: From start of today to now (hourly buckets)
            - `1hr`: Last 1 hour (minute buckets)
            - `3hr`: Last 3 hours (minute buckets)
            - `24hr`: Last 24 hours (hourly buckets)
            - `7d`: Last 7 days (hourly buckets)
            - `30d`: Last 30 days (daily buckets)

            If both `period` and `start`/`end` are provided, `start`/`end` takes precedence.
        - name: start
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: |
            Start time for custom datetime range (RFC3339 format).
            Must be provided together with `end`.
            Example: `2024-01-01T00:00:00Z`
        - name: end
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: |
            End time for custom datetime range (RFC3339 format).
            Must be provided together with `start`.
            Must be after `start`.
            Example: `2024-01-01T23:59:59Z`
      responses:
        '200':
          description: Uptime data aggregated by time buckets
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                  - period
                  - start_time
                  - end_time
                  - time_bucket
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/UptimeDataPoint'
                    description: Array of uptime data points, sorted chronologically
                  period:
                    type: string
                    description: |
                      Period identifier. Either one of the preset values (today, 1hr, 3hr, 24hr, 7d, 30d)
                      or "custom" if using start/end datetime range.
                    example: 24hr
                  start_time:
                    type: string
                    format: date-time
                    description: Start time of the data range (RFC3339 format)
                    example: '2024-01-01T00:00:00Z'
                  end_time:
                    type: string
                    format: date-time
                    description: End time of the data range (RFC3339 format)
                    example: '2024-01-01T23:59:59Z'
                  time_bucket:
                    type: string
                    enum: [minute, hour, day]
                    description: |
                      Time bucket used for aggregation:
                      - `minute`: For ranges less than 3 hours
                      - `hour`: For ranges less than 7 days
                      - `day`: For ranges 7 days or more
                    example: hour
        '400':
          $ref: '#/components/responses/Error'
          description: |
            Bad request. Possible reasons:
            - Invalid period value
            - Invalid datetime format for start/end
            - Start time is after end time
            - Only one of start/end provided (both required)
        '401':
          $ref: '#/components/responses/Error'
        '403':
          $ref: '#/components/responses/Error'
        '404':
          $ref: '#/components/responses/Error'
        '500':
          $ref: '#/components/responses/Error'

  /internal/projects/{projectId}/checks/{checkId}/timings:
    get:
      operationId: getCheckTimings
      summary: Get timing data for a check
      description: |
        Returns timing data for all check runs within a specified time period.
        Unlike the uptime endpoint, this returns raw timing data points (one per check run)
        without aggregation. Each data point includes the network timings from the check run.
        Supports both period presets and custom datetime ranges.
      tags:
        - Check Runs
      security:
        - BearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the project
        - name: checkId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the check
        - name: period
          in: query
          required: false
          schema:
            type: string
            enum: [today, 1hr, 3hr, 24hr, 7d, 30d]
            default: 24hr
          description: |
            Time period preset. Options:
            - `today`: From start of today to now
            - `1hr`: Last 1 hour
            - `3hr`: Last 3 hours
            - `24hr`: Last 24 hours
            - `7d`: Last 7 days
            - `30d`: Last 30 days

            If both `period` and `start`/`end` are provided, `start`/`end` takes precedence.
        - name: start
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: |
            Start time for custom datetime range (RFC3339 format).
            Must be provided together with `end`.
            Example: `2024-01-01T00:00:00Z`
        - name: end
          in: query
          required: false
          schema:
            type: string
            format: date-time
          description: |
            End time for custom datetime range (RFC3339 format).
            Must be provided together with `start`.
            Must be after `start`.
            Example: `2024-01-01T23:59:59Z`
      responses:
        '200':
          description: Timing data for check runs
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                  - period
                  - start_time
                  - end_time
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/TimingDataPoint'
                    description: Array of timing data points, one per check run, sorted chronologically
                  period:
                    type: string
                    description: |
                      Period identifier. Either one of the preset values (today, 1hr, 3hr, 24hr, 7d, 30d)
                      or "custom" if using start/end datetime range.
                    example: 24hr
                  start_time:
                    type: string
                    format: date-time
                    description: Start time of the data range (RFC3339 format)
                    example: '2024-01-01T00:00:00Z'
                  end_time:
                    type: string
                    format: date-time
                    description: End time of the data range (RFC3339 format)
                    example: '2024-01-01T23:59:59Z'
        '400':
          $ref: '#/components/responses/Error'
          description: |
            Bad request. Possible reasons:
            - Invalid period value
            - Invalid datetime format for start/end
            - Start time is after end time
            - Only one of start/end provided (both required)
        '401':
          $ref: '#/components/responses/Error'
        '403':
          $ref: '#/components/responses/Error'
        '404':
          $ref: '#/components/responses/Error'
        '500':
          $ref: '#/components/responses/Error'

  /internal/projects/{projectId}/checks/{checkId}/runs/{runId}:
    get:
      operationId: getCheckRunById
      summary: Get a check run by ID
      description: |
        Returns detailed information about a specific check run, including status, response details,
        assertion results, network timings, and other execution metadata.
        The check run must belong to the specified check, and the check must belong to the specified project.
      tags:
        - Check Runs
      security:
        - BearerAuth: []
      parameters:
        - name: projectId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the project
        - name: checkId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the check
        - name: runId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: The ID of the check run
      responses:
        '200':
          description: Check run details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckRun'
        '400':
          $ref: '#/components/responses/Error'
          description: |
            Bad request. Possible reasons:
            - Invalid project ID format
            - Invalid check ID format
            - Invalid check run ID format
        '401':
          $ref: '#/components/responses/Error'
          description: Unauthorized. Authentication token is missing or invalid.
        '403':
          $ref: '#/components/responses/Error'
          description: Forbidden. User does not have access to the project.
        '404':
          $ref: '#/components/responses/Error'
          description: |
            Not found. Possible reasons:
            - Check run does not exist
            - Check run does not belong to the specified check
            - Check does not belong to the specified project
